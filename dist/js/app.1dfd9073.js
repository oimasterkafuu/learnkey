(function(){"use strict";var e={1234:function(e,i,t){var s=t(9242),n=t(3396);function r(e,i,t,s,r,h){const l=(0,n.up)("router-view"),o=(0,n.up)("PageFooter");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(l),(0,n.Wm)(o)],64)}var h=t(7139);function l(e,i,t,s,r,l){return(0,n.wg)(),(0,n.iD)("footer",null,"© "+(0,h.zw)(l.copyright)+" oimasterkafuu",1)}var o={name:"PageFooter",computed:{copyright(){const e=2023,i=(new Date).getFullYear();return`${e}${e!==i?`-${i}`:""}`}}},a=t(89);const g=(0,a.Z)(o,[["render",l],["__scopeId","data-v-30284bbc"]]);var d=g,y={name:"App",components:{PageFooter:d}};console.log("%cMade by oimaster with ❤️","color: #8db3f1; font-size: 2em; font-weight: bold;");const c=(0,a.Z)(y,[["render",r]]);var k=c,u=t(5431);(0,u.z)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});var p=t(2483);function w(e,i,t,s,r,h){const l=(0,n.up)("PageHeader"),o=(0,n.up)("SelectBar"),a=(0,n.up)("SpinLoader");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(l,{title:"欢迎来到 Learn Key！",description:h.aisatsu},null,8,["description"]),(0,n._)("main",null,[r.loaded?((0,n.wg)(),(0,n.j4)(o,{key:0,options:r.options,onSelected:h.optionSelected},null,8,["options","onSelected"])):(0,n.kq)("",!0)]),r.loaded?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(a,{key:0}))],64)}t(7658);const m={class:"title"},f={class:"description"};function K(e,i,t,s,r,l){return(0,n.wg)(),(0,n.iD)("header",null,[(0,n._)("h1",m,(0,h.zw)(t.title),1),(0,n._)("p",f,(0,h.zw)(t.description),1)])}var b={name:"PageHeader",props:{title:{type:String,required:!0},description:{type:String,required:!0}}};const v=(0,a.Z)(b,[["render",K],["__scopeId","data-v-050e13a1"]]);var _=v;const C={class:"select-bar"};function S(e,i,t,s,r,h){const l=(0,n.up)("SelectOption");return(0,n.wg)(),(0,n.iD)("div",C,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.options,((e,i)=>((0,n.wg)(),(0,n.j4)(l,{key:i,title:e.title,description:e.description,onClick:e=>h.emitSelected(i)},null,8,["title","description","onClick"])))),128))])}const W={class:"select-option"},D={class:"title"},I={class:"description"};function H(e,i,t,s,r,l){return(0,n.wg)(),(0,n.iD)("div",W,[(0,n._)("h3",D,(0,h.zw)(t.title),1),(0,n._)("p",I,(0,h.zw)(t.description),1)])}var q={name:"SelectOption",props:{title:{type:String,required:!0},description:{type:String,required:!0}}};const j=(0,a.Z)(q,[["render",H],["__scopeId","data-v-3ed0f7aa"]]);var z=j,M={name:"SelectBar",components:{SelectOption:z},props:{options:{type:Object,required:!0}},methods:{emitSelected(e){this.$emit("selected",e)}}};const L=(0,a.Z)(M,[["render",S],["__scopeId","data-v-4a2c3522"]]);var $=L;const R=e=>((0,n.dD)("data-v-572f999d"),e=e(),(0,n.Cn)(),e),O={class:"loading-mask"},B=R((()=>(0,n._)("div",{class:"loading-spinner"},null,-1))),E=[B];function P(e,i,t,s,r,h){return(0,n.wg)(),(0,n.iD)("div",O,E)}var Z={name:"SpinLoader"};const x=(0,a.Z)(Z,[["render",P],["__scopeId","data-v-572f999d"]]);var T=x,U={name:"HomeView",components:{PageHeader:_,SelectBar:$,SpinLoader:T},data(){return{options:[],loaded:!1}},computed:{aisatsu(){const e=new Date,i=e.getHours();return i<6?"这么早就来看我啦？是有什么高兴的事吗？":i<9?"一日之际在于晨，要不来练个单元？":i<12?"今天一天也要加油哦！":i<13?"睡一个午觉，能让人下午更有精神哦！":i<17?"今天的单元练习做完了吗？":i<19?"一天的工作辛苦了！":i<22?"晚上好，一天过得真快呀！":"熬夜对身体不太好，偶尔一次也是挺有意思的呢！"}},methods:{async fetchOptions(){const e=await fetch("/lessons/oimaster.json"),i=await e.json();this.options=i,this.loaded=!0},optionSelected(e){this.$router.push(`/lesson/${e}`)}},mounted(){this.fetchOptions()}};const A=(0,a.Z)(U,[["render",w]]);var F=A;function Y(e,i,t,s,r,h){const l=(0,n.up)("PageHeader"),o=(0,n.up)("SelectBar"),a=(0,n.up)("SpinLoader");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(l,{title:r.lessonTitle,description:r.lessonDescription},null,8,["title","description"]),(0,n._)("main",null,[r.loaded?((0,n.wg)(),(0,n.j4)(o,{key:0,options:r.options,onSelected:h.optionSelected},null,8,["options","onSelected"])):(0,n.kq)("",!0)]),r.loaded?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(a,{key:0}))],64)}var J={name:"LessonView",components:{PageHeader:_,SelectBar:$,SpinLoader:T},data(){return{lessonTitle:"",lessonDescription:"",id:this.$route.params.id,options:[],loaded:!1}},methods:{async fetchTitle(){try{const e=await fetch("/lessons/oimaster.json"),i=await e.json();if(!i[this.id])throw new Error("Invalid lesson id");this.lessonTitle=i[this.id].title,this.lessonDescription=i[this.id].description,this.fetchOptions()}catch(e){return console.log(e.message),void this.$router.push("/")}},async fetchOptions(){const e=await fetch(`/lessons/${this.id}/oimaster.json`),i=await e.json();this.options=i,this.loaded=!0},optionSelected(e){this.$router.push(`/lesson/${this.id}/${e}`)}},mounted(){this.fetchTitle()}};const V=(0,a.Z)(J,[["render",Y]]);var N=V;const Q={class:"unit-interaction"};function G(e,i,t,s,r,h){const l=(0,n.up)("PageHeader"),o=(0,n.up)("MagicViewer"),a=(0,n.up)("MagicHint"),g=(0,n.up)("MagicKeyboard"),d=(0,n.up)("BeautifulProgress"),y=(0,n.up)("SpinLoader"),c=(0,n.up)("FinishDialog");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(l,{title:r.unitTitle,description:r.unitDescription},null,8,["title","description"]),(0,n._)("main",null,[r.loaded&&!r.finished?((0,n.wg)(),(0,n.j4)(o,{row:r.unitContent[r.rowId],currInput:r.currInput,key:r.currInput},null,8,["row","currInput"])):(0,n.kq)("",!0),r.loaded&&!r.finished?((0,n.wg)(),(0,n.j4)(a,{keyboard:r.keyboardJson,content:h.nextChar,showHint:r.showHint,key:r.currInput},null,8,["keyboard","content","showHint"])):(0,n.kq)("",!0),(0,n._)("div",Q,[r.loaded&&!r.finished?((0,n.wg)(),(0,n.j4)(g,{key:0,onInput:h.input,keyboard:r.keyboardJson,leftInfo:r.kpmSpeed>10?"Speed: "+r.kpmSpeed+" KPM":"oimaster"},null,8,["onInput","keyboard","leftInfo"])):(0,n.kq)("",!0),r.loaded&&!r.finished?((0,n.wg)(),(0,n.j4)(d,{key:1,progress:r.rowId/r.unitContent.length},null,8,["progress"])):(0,n.kq)("",!0)])]),r.loaded?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(y,{key:0})),r.finished?((0,n.wg)(),(0,n.j4)(c,{key:1})):(0,n.kq)("",!0)],64)}const X=e=>((0,n.dD)("data-v-6fa60786"),e=e(),(0,n.Cn)(),e),ee={class:"keyboard",id:"keyboard"},ie={class:"keyboardRow"},te={class:"keyboardRow"},se={class:"keyboardRow"},ne={class:"keyboardRow"},re={class:"keyboardRow"},he={class:"spaceLeft"},le=X((()=>(0,n._)("div",{class:"spaceRight"},"oimaster",-1)));function oe(e,i,t,s,r,l){const o=(0,n.up)("MagicKey");return(0,n.wg)(),(0,n.iD)("div",ee,[(0,n._)("div",ie,[(0,n.Wm)(o,{class:(0,h.C_)(["op",{highlighted:1===r.highlighted["key-backtick"],error:-1===r.highlighted["key-backtick"]}]),singleKey:t.keyboard.show["key-backtick"]},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-1"],class:(0,h.C_)({highlighted:1===r.highlighted["key-1"],error:-1===r.highlighted["key-1"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-2"],class:(0,h.C_)({highlighted:1===r.highlighted["key-2"],error:-1===r.highlighted["key-2"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-3"],class:(0,h.C_)({highlighted:1===r.highlighted["key-3"],error:-1===r.highlighted["key-3"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-4"],class:(0,h.C_)({highlighted:1===r.highlighted["key-4"],error:-1===r.highlighted["key-4"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-5"],class:(0,h.C_)({highlighted:1===r.highlighted["key-5"],error:-1===r.highlighted["key-5"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-6"],class:(0,h.C_)({highlighted:1===r.highlighted["key-6"],error:-1===r.highlighted["key-6"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-7"],class:(0,h.C_)({highlighted:1===r.highlighted["key-7"],error:-1===r.highlighted["key-7"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-8"],class:(0,h.C_)({highlighted:1===r.highlighted["key-8"],error:-1===r.highlighted["key-8"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-9"],class:(0,h.C_)({highlighted:1===r.highlighted["key-9"],error:-1===r.highlighted["key-9"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-0"],class:(0,h.C_)({highlighted:1===r.highlighted["key-0"],error:-1===r.highlighted["key-0"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-minus"],class:(0,h.C_)({highlighted:1===r.highlighted["key-minus"],error:-1===r.highlighted["key-minus"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-equal"],class:(0,h.C_)({highlighted:1===r.highlighted["key-equal"],error:-1===r.highlighted["key-equal"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{class:(0,h.C_)(["backspace op",{highlighted:1===r.highlighted["key-backspace"],error:-1===r.highlighted["key-backspace"]}]),singleKey:t.keyboard.show["key-backspace"]},null,8,["singleKey","class"])]),(0,n._)("div",te,[(0,n.Wm)(o,{class:(0,h.C_)(["tab op",{highlighted:1===r.highlighted["key-tab"],error:-1===r.highlighted["key-tab"]}]),singleKey:t.keyboard.show["key-tab"]},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-q"],class:(0,h.C_)({highlighted:1===r.highlighted["key-q"],error:-1===r.highlighted["key-q"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-w"],class:(0,h.C_)({highlighted:1===r.highlighted["key-w"],error:-1===r.highlighted["key-w"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-e"],class:(0,h.C_)({highlighted:1===r.highlighted["key-e"],error:-1===r.highlighted["key-e"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-r"],class:(0,h.C_)({highlighted:1===r.highlighted["key-r"],error:-1===r.highlighted["key-r"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-t"],class:(0,h.C_)({highlighted:1===r.highlighted["key-t"],error:-1===r.highlighted["key-t"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-y"],class:(0,h.C_)({highlighted:1===r.highlighted["key-y"],error:-1===r.highlighted["key-y"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-u"],class:(0,h.C_)({highlighted:1===r.highlighted["key-u"],error:-1===r.highlighted["key-u"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-i"],class:(0,h.C_)({highlighted:1===r.highlighted["key-i"],error:-1===r.highlighted["key-i"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-o"],class:(0,h.C_)({highlighted:1===r.highlighted["key-o"],error:-1===r.highlighted["key-o"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-p"],class:(0,h.C_)({highlighted:1===r.highlighted["key-p"],error:-1===r.highlighted["key-p"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-left-bracket"],class:(0,h.C_)({highlighted:1===r.highlighted["key-left-bracket"],error:-1===r.highlighted["key-left-bracket"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-right-bracket"],class:(0,h.C_)({highlighted:1===r.highlighted["key-right-bracket"],error:-1===r.highlighted["key-right-bracket"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-backslash"],class:(0,h.C_)({highlighted:1===r.highlighted["key-backslash"],error:-1===r.highlighted["key-backslash"]})},null,8,["singleKey","class"])]),(0,n._)("div",se,[(0,n.Wm)(o,{class:(0,h.C_)(["capslock op",{highlighted:r.capslock}]),singleKey:t.keyboard.show["key-capslock"]},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-a"],class:(0,h.C_)({highlighted:1===r.highlighted["key-a"],error:-1===r.highlighted["key-a"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-s"],class:(0,h.C_)({highlighted:1===r.highlighted["key-s"],error:-1===r.highlighted["key-s"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-d"],class:(0,h.C_)({highlighted:1===r.highlighted["key-d"],error:-1===r.highlighted["key-d"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-f"],class:(0,h.C_)({highlighted:1===r.highlighted["key-f"],error:-1===r.highlighted["key-f"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-g"],class:(0,h.C_)({highlighted:1===r.highlighted["key-g"],error:-1===r.highlighted["key-g"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-h"],class:(0,h.C_)({highlighted:1===r.highlighted["key-h"],error:-1===r.highlighted["key-h"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-j"],class:(0,h.C_)({highlighted:1===r.highlighted["key-j"],error:-1===r.highlighted["key-j"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-k"],class:(0,h.C_)({highlighted:1===r.highlighted["key-k"],error:-1===r.highlighted["key-k"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-l"],class:(0,h.C_)({highlighted:1===r.highlighted["key-l"],error:-1===r.highlighted["key-l"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-semicolon"],class:(0,h.C_)({highlighted:1===r.highlighted["key-semicolon"],error:-1===r.highlighted["key-semicolon"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-quote"],class:(0,h.C_)({highlighted:1===r.highlighted["key-quote"],error:-1===r.highlighted["key-quote"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{class:(0,h.C_)(["enter op",{highlighted:1===r.highlighted["key-enter"],error:-1===r.highlighted["key-enter"]}]),singleKey:t.keyboard.show["key-enter"]},null,8,["singleKey","class"])]),(0,n._)("div",ne,[(0,n.Wm)(o,{class:(0,h.C_)(["shift op",{highlighted:1===r.highlighted["key-shift-left"],error:-1===r.highlighted["key-shift-left"]}]),singleKey:t.keyboard.show["key-shift-left"]},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-z"],class:(0,h.C_)({highlighted:1===r.highlighted["key-z"],error:-1===r.highlighted["key-z"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-x"],class:(0,h.C_)({highlighted:1===r.highlighted["key-x"],error:-1===r.highlighted["key-x"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-c"],class:(0,h.C_)({highlighted:1===r.highlighted["key-c"],error:-1===r.highlighted["key-c"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-v"],class:(0,h.C_)({highlighted:1===r.highlighted["key-v"],error:-1===r.highlighted["key-v"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-b"],class:(0,h.C_)({highlighted:1===r.highlighted["key-b"],error:-1===r.highlighted["key-b"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-n"],class:(0,h.C_)({highlighted:1===r.highlighted["key-n"],error:-1===r.highlighted["key-n"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-m"],class:(0,h.C_)({highlighted:1===r.highlighted["key-m"],error:-1===r.highlighted["key-m"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-comma"],class:(0,h.C_)({highlighted:1===r.highlighted["key-comma"],error:-1===r.highlighted["key-comma"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-period"],class:(0,h.C_)({highlighted:1===r.highlighted["key-period"],error:-1===r.highlighted["key-period"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{singleKey:t.keyboard.show["key-slash"],class:(0,h.C_)({highlighted:1===r.highlighted["key-slash"],error:-1===r.highlighted["key-slash"]})},null,8,["singleKey","class"]),(0,n.Wm)(o,{class:(0,h.C_)(["shift op",{highlighted:1===r.highlighted["key-shift-right"],error:-1===r.highlighted["key-shift-right"]}]),singleKey:t.keyboard.show["key-shift-right"]},null,8,["singleKey","class"])]),(0,n._)("div",re,[(0,n._)("div",he,(0,h.zw)(t.leftInfo),1),(0,n.Wm)(o,{class:(0,h.C_)(["space",{highlighted:1===r.highlighted["key-space"],error:-1===r.highlighted["key-space"]}]),singleKey:t.keyboard.show["key-space"]},null,8,["singleKey","class"]),le])])}var ae=JSON.parse('{"Backquote":"key-backtick","Digit1":"key-1","Digit2":"key-2","Digit3":"key-3","Digit4":"key-4","Digit5":"key-5","Digit6":"key-6","Digit7":"key-7","Digit8":"key-8","Digit9":"key-9","Digit0":"key-0","Minus":"key-minus","Equal":"key-equal","Backspace":"key-backspace","Tab":"key-tab","KeyQ":"key-q","KeyW":"key-w","KeyE":"key-e","KeyR":"key-r","KeyT":"key-t","KeyY":"key-y","KeyU":"key-u","KeyI":"key-i","KeyO":"key-o","KeyP":"key-p","BracketLeft":"key-left-bracket","BracketRight":"key-right-bracket","Backslash":"key-backslash","CapsLock":"key-capslock","KeyA":"key-a","KeyS":"key-s","KeyD":"key-d","KeyF":"key-f","KeyG":"key-g","KeyH":"key-h","KeyJ":"key-j","KeyK":"key-k","KeyL":"key-l","Semicolon":"key-semicolon","Quote":"key-quote","Enter":"key-enter","ShiftLeft":"key-shift-left","KeyZ":"key-z","KeyX":"key-x","KeyC":"key-c","KeyV":"key-v","KeyB":"key-b","KeyN":"key-n","KeyM":"key-m","Comma":"key-comma","Period":"key-period","Slash":"key-slash","ShiftRight":"key-shift-right","Space":"key-space"}');const ge={class:"key"},de={key:0},ye={key:1};function ce(e,i,t,s,r,l){return(0,n.wg)(),(0,n.iD)("div",ge,["string"===typeof t.singleKey?((0,n.wg)(),(0,n.iD)("div",de,(0,h.zw)(t.singleKey),1)):((0,n.wg)(),(0,n.iD)("ruby",ye,[(0,n.Uk)((0,h.zw)(t.singleKey[0])+" ",1),(0,n._)("rt",null,(0,h.zw)(t.singleKey[1]),1)]))])}var ke={name:"MagicKey",props:{singleKey:{type:[String,Array],required:!0}}};const ue=(0,a.Z)(ke,[["render",ce],["__scopeId","data-v-e9058e7c"]]);var pe=ue,we={name:"MagicKeyboard",emits:["input"],components:{MagicKey:pe},props:{keyboard:{type:Object,required:!0},leftInfo:{type:String,default:"oimaster"}},data(){return{keys:ae,capslock:!1,highlighted:{}}},methods:{input(e){this.$emit("input",e)},highlightKey(e){var i=this.keys[e];i&&(this.highlighted[i]=1)},unHighlightKey(e){var i=this.keys[e];i&&(this.highlighted[i]=0)},errorKey(e){var i=this.keys[e];i&&(this.highlighted[i]=-1)},handleKeyDown(e){const i=e.code,t=e.shiftKey,s=e.metaKey,n=e.altKey,r=e.ctrlKey;if(!(s||n||r)){if("CapsLock"===i)this.capslock=!this.capslock;else if(i.startsWith("Shift"))this.highlightKey(i);else{var h=this.keys[i];if(!h)return;var l=this.keyboard.type[h],o="";o=t&&l.shift?l.shift:(t||this.capslock)&&l.capslock?l.capslock:l.default,o?(this.input(o),this.highlightKey(i)):this.errorKey(i)}e.preventDefault()}},handleKeyUp(e){const i=e.code;this.keys[i]&&this.unHighlightKey(i)},handleResize(){const e=document.getElementById("keyboard");e.style.height=`${Math.max(e.offsetWidth/3,250)}px`}},mounted(){this.capslock=!1,addEventListener("keydown",this.handleKeyDown),addEventListener("keyup",this.handleKeyUp),addEventListener("resize",this.handleResize),this.handleResize()},beforeUnmount(){removeEventListener("keydown",this.handleKeyDown),removeEventListener("keyup",this.handleKeyUp),removeEventListener("resize",this.handleResize)}};const me=(0,a.Z)(we,[["render",oe],["__scopeId","data-v-6fa60786"]]);var fe=me;const Ke={key:0,class:"hint"},be={key:1,class:"no-hint"};function ve(e,i,t,s,r,h){const l=(0,n.up)("MagicKey");return(0,n.wg)(),(0,n.iD)("div",null,[t.showHint?((0,n.wg)(),(0,n.iD)("div",Ke,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.answer,((e,i)=>((0,n.wg)(),(0,n.j4)(l,{singleKey:t.keyboard.show[e],key:i,class:"hint-key"},null,8,["singleKey"])))),128))])):((0,n.wg)(),(0,n.iD)("div",be,[(0,n.Uk)(" 按下 "),(0,n.Wm)(l,{singleKey:t.keyboard.show["key-control"],class:"hint-key"},null,8,["singleKey"]),(0,n.Uk)(" 键显示提示！ ")]))])}var _e={name:"MagicKeyboard",components:{MagicKey:pe},props:{keyboard:{type:Object,required:!0},content:{type:String,required:!0},showHint:{type:Boolean,default:!1}},data(){return{answer:[]}},methods:{makeHint(e){for(var i in this.keyboard.multi)if(this.keyboard.multi[i]===e){var t=[];for(var s of i)t.push(...this.makeHint(s));return t}for(var n in this.keyboard.type){if(this.keyboard.type[n].default===e)return[n];if(this.keyboard.type[n].shift===e)return["key-shift-left",n];if(this.keyboard.type[n].capslock===e)return["key-capslock",n]}return[]}},mounted(){this.answer=this.makeHint(this.content)}};const Ce=(0,a.Z)(_e,[["render",ve],["__scopeId","data-v-188f6752"]]);var Se=Ce;const We={class:"viewer"},De={class:"viewer-main"};function Ie(e,i,t,s,r,l){return(0,n.wg)(),(0,n.iD)("div",We,[(0,n._)("div",De,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.render,((e,i)=>((0,n.wg)(),(0,n.iD)("span",{key:i},["string"===typeof e.char?((0,n.wg)(),(0,n.iD)("span",{key:0,class:(0,h.C_)({finished:e.finished})},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.more,((e,i)=>((0,n.wg)(),(0,n.iD)("del",{key:i},(0,h.zw)(e),1)))),128)),(0,n._)("span",null,(0,h.zw)(e.char),1)],2)):((0,n.wg)(),(0,n.iD)("ruby",{key:1,class:(0,h.C_)({finished:e.finished[e.finished.length-1]})},[(0,n.Uk)((0,h.zw)(e.char[0])+" ",1),(0,n._)("rt",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.char[1],((i,t)=>((0,n.wg)(),(0,n.iD)("span",{key:t,class:(0,h.C_)({finished:e.finished[t]})},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.more[t],((e,i)=>((0,n.wg)(),(0,n.iD)("del",{key:i},(0,h.zw)(e),1)))),128)),(0,n._)("span",null,(0,h.zw)(i),1)],2)))),128))])],2))])))),128))])])}var He={name:"MagicViewer",props:{row:{type:[String,Array],required:!0},currInput:{type:String,required:!0}},data(){return{render:[],newRow:[]}},computed:{finished(){var e=0,i=0;for(var t of this.newRow)if("string"===typeof t)for(let s of t){if(this.currInput[i]!=s)return e-1;++i,++e}else if(Array.isArray(t))for(let s of t[1]){if(this.currInput[i]!=s)return e-1;++i,++e}return e-1}},methods:{autoSize(){var e=this.$el.offsetWidth-32,i=this.$el.querySelector(".viewer-main").scrollWidth,t=e/i,s=t,n=parseFloat(getComputedStyle(this.$el.querySelector(".viewer-main")).fontSize),r=Math.min(32,s*n);this.$el.querySelector(".viewer-main").style.fontSize=r+"px"}},mounted(){this.newRow=this.row,"string"===typeof this.newRow&&(this.newRow=[this.newRow]);for(var e=this.finished,i=0,t=0;t<this.newRow.length;++t)if("string"===typeof this.newRow[t])for(var s=0;s<this.newRow[t].length;++s)this.render.push({char:this.newRow[t][s],finished:i<=e,more:i===e+1?this.currInput.slice(i):""}),++i;else if(Array.isArray(this.newRow[t])){for(var n=[],r=0;r<this.newRow[t][1].length;++r)n.push({finished:i<=e,more:i===e+1?this.currInput.slice(i):""}),++i;this.render.push({char:this.newRow[t],finished:n.map((e=>e.finished)),more:n.map((e=>e.more))})}},beforeUnmount(){window.removeEventListener("resize",this.autoSize)},updated(){this.autoSize(),window.addEventListener("resize",this.autoSize)}};const qe=(0,a.Z)(He,[["render",Ie],["__scopeId","data-v-616f2f30"]]);var je=qe;const ze={class:"progress"},Me={key:0,class:"progress-text"};function Le(e,i,t,s,r,l){return(0,n.wg)(),(0,n.iD)("div",ze,[(0,n._)("div",{class:"progress-bar",role:"progressbar",style:(0,h.j5)({width:100*t.progress+"%"})},[Math.round(100*t.progress)>0?((0,n.wg)(),(0,n.iD)("div",Me,(0,h.zw)(Math.round(100*t.progress))+"% ",1)):(0,n.kq)("",!0)],4)])}var $e={name:"BeautifulProgress",props:{progress:{type:Number,required:!0}}};const Re=(0,a.Z)($e,[["render",Le],["__scopeId","data-v-6e9a0f66"]]);var Oe=Re;function Be(e,i,t,s,r,h){const l=(0,n.up)("BoomDialog");return(0,n.wg)(),(0,n.j4)(l,{header:h.header,content:h.content},null,8,["header","content"])}const Ee={class:"boom-main"};function Pe(e,i,t,s,r,l){return(0,n.wg)(),(0,n.iD)("div",{class:"boom-mask",onClick:i[0]||(i[0]=(...e)=>l.back&&l.back(...e))},[(0,n._)("div",Ee,[(0,n._)("h1",null,(0,h.zw)(t.header),1),(0,n._)("p",null,(0,h.zw)(t.content)+"点击任意位置返回。",1)])])}var Ze={name:"BoomDialog",props:{header:{type:String,required:!0},content:{type:String,required:!0}},methods:{back(){this.$router.back()}}};const xe=(0,a.Z)(Ze,[["render",Pe],["__scopeId","data-v-e2165c8e"]]);var Te=xe,Ue={name:"PageFooter",components:{BoomDialog:Te},data(){return{headers:["太棒了！","好！","妙啊！","干得漂亮！","你真棒！","我们佩服得五体投地！","你是最棒的！","泰裤辣！","我整个人都被震撼了！","高手！","轻轻松松！"],contents:["你完成了这个单元。","你轻轻松松地通过了这个单元！","这点难度对你来说太简单了！","你的水平已经远远超过了这个单元！","我还没见过像你这么厉害的人呢！","我的饼干还没拿出来，你就完成啦？！","吓得我零食都掉了一地！"]}},computed:{header(){return this.headers[Math.floor(Math.random()*this.headers.length)]},content(){return this.contents[Math.floor(Math.random()*this.contents.length)]}}};const Ae=(0,a.Z)(Ue,[["render",Be]]);var Fe=Ae,Ye={name:"UnitView",components:{PageHeader:_,MagicKeyboard:fe,MagicHint:Se,MagicViewer:je,SpinLoader:T,BeautifulProgress:Oe,FinishDialog:Fe},data(){return{unitTitle:"",unitDescription:"",id:this.$route.params.id,unit:this.$route.params.unit,unitContent:[],rowId:0,keyboardJson:{},currInput:"",showHint:!1,loaded:!1,finished:!1,keysIn10Seconds:0,kpmSpeed:0,kpmTimer:null}},computed:{nextChar(){var e=this.unitContent[this.rowId],i="";for(var t of e)"string"===typeof t?i+=t:Array.isArray(t)&&(i+=t[1]);for(var s=0;s<i.length;s++)if(i[s]!==this.currInput[s])break;return s===i.length?null:i[s]}},methods:{input(e){++this.keysIn10Seconds,"\b"!==e?this.currInput+=e:this.currInput=this.currInput.slice(0,-1);do{var i=!1;for(var t in this.keyboardJson.multi)if(this.currInput.endsWith(t)){this.currInput=this.currInput.slice(0,-t.length)+this.keyboardJson.multi[t],i=!0;break}}while(i);null===this.nextChar&&(++this.rowId,this.currInput="",this.rowId===this.unitContent.length&&(this.finished=!0,--this.rowId))},async fetchHeader(){try{const e=await fetch(`/lessons/${this.id}/oimaster.json`),i=await e.json();if(!i[this.unit])throw new Error("Invalid unit id");this.unitTitle=i[this.unit].title,this.unitDescription=i[this.unit].description,this.fetchUnitContent()}catch(e){return console.log(e.message),void this.$router.push(`/lesson/${this.id}/`)}},async fetchUnitContent(){const e=await fetch(`/lessons/${this.id}/${this.unit}.json`),i=await e.json();this.unitContent=i,this.fetchKeyboardJson()},async fetchKeyboardJson(){const e=await fetch(`/lessons/${this.id}/keyboard.json`),i=await e.json();this.keyboardJson=i,this.loaded=!0},pressShowHint(e){"Control"===e.key&&(this.showHint=!0)},pressHideHint(e){"Control"===e.key&&(this.showHint=!1)},countKpm(){this.kpmSpeed=6*this.keysIn10Seconds,this.keysIn10Seconds=0}},mounted(){this.fetchHeader(),document.addEventListener("keydown",this.pressShowHint),document.addEventListener("keyup",this.pressHideHint),this.kpmTimer=setInterval(this.countKpm,1e4)},beforeUnmount(){document.removeEventListener("keydown",this.pressShowHint),document.removeEventListener("keyup",this.pressHideHint),clearInterval(this.kpmTimer)}};const Je=(0,a.Z)(Ye,[["render",G],["__scopeId","data-v-941eff44"]]);var Ve=Je;const Ne=[{path:"/",name:"home",component:F},{path:"/lesson/:id",name:"lesson",component:N},{path:"/lesson/:id/:unit",name:"unit",component:Ve},{path:"/:pathMatch(.*)*",redirect:"/"}],Qe=(0,p.p7)({history:(0,p.r5)(),routes:Ne});var Ge=Qe;(0,s.ri)(k).use(Ge).mount("#app")}},i={};function t(s){var n=i[s];if(void 0!==n)return n.exports;var r=i[s]={exports:{}};return e[s].call(r.exports,r,r.exports,t),r.exports}t.m=e,function(){var e=[];t.O=function(i,s,n,r){if(!s){var h=1/0;for(g=0;g<e.length;g++){s=e[g][0],n=e[g][1],r=e[g][2];for(var l=!0,o=0;o<s.length;o++)(!1&r||h>=r)&&Object.keys(t.O).every((function(e){return t.O[e](s[o])}))?s.splice(o--,1):(l=!1,r<h&&(h=r));if(l){e.splice(g--,1);var a=n();void 0!==a&&(i=a)}}return i}r=r||0;for(var g=e.length;g>0&&e[g-1][2]>r;g--)e[g]=e[g-1];e[g]=[s,n,r]}}(),function(){t.n=function(e){var i=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(i,{a:i}),i}}(),function(){t.d=function(e,i){for(var s in i)t.o(i,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:i[s]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)}}(),function(){var e={143:0};t.O.j=function(i){return 0===e[i]};var i=function(i,s){var n,r,h=s[0],l=s[1],o=s[2],a=0;if(h.some((function(i){return 0!==e[i]}))){for(n in l)t.o(l,n)&&(t.m[n]=l[n]);if(o)var g=o(t)}for(i&&i(s);a<h.length;a++)r=h[a],t.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return t.O(g)},s=self["webpackChunklearnkey"]=self["webpackChunklearnkey"]||[];s.forEach(i.bind(null,0)),s.push=i.bind(null,s.push.bind(s))}();var s=t.O(void 0,[998],(function(){return t(1234)}));s=t.O(s)})();
//# sourceMappingURL=app.1dfd9073.js.map